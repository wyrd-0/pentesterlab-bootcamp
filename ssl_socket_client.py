import socket
import sys
import ssl

#!!!MAKE SURE HOSTNAME IS 'vulnerable'!!!

#SET VARS
HOST = 'vulnerable'
PORT = 443
req = b"GET / HTTP/1.1\r\nHost: vulnerable\r\n\r\n"

#GET CERT & CREATE SSL CONTEXT
cert = ssl.get_server_certificate((HOST,PORT))

context = ssl.SSLContext(ssl.PROTOCOL_TLS_CLIENT)
context.load_verify_locations(cadata=cert)

#CREATE SOCKET
sock = socket.socket(socket.AF_INET,socket.SOCK_STREAM)
sock.settimeout(10)

#WRAP SOCKET
wrappedsocket = context.wrap_socket(sock, server_hostname = HOST)

#REQ. & PRINT DATA
wrappedsocket.connect((HOST,PORT))

wrappedsocket.send(req)

html = wrappedsocket.recv(1024).decode()

print(html)

#CLOSE SOCKET CONNECTION
wrappedsocket.close()
